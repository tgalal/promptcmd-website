{{ define "main" }}
<div class="container-fluid">
  <div class="home-nav">
      {{ partial "nav-links.html" . }}
  </div>
  <div class="home-header">
      <h1>promptcmd</h1>
      <p class="tagline">GenAI prompts as runnable programs</p>

      {{ partial "showcase.html" . }}
      <p class="subtitle">Create custom CLI commands powered by AI. No plugins, no friction.<br />Just pure command-line magic.</p>
      <div class="header-links">
          <a href="#install-section" class="link-btn install-scroll">
              <span class="btn-icon">⬇</span> Get Started
          </a>
          <a href="https://docs.promptcmd.sh" class="link-btn library">
              Read the Docs
          </a>
          <a href="https://github.com/{{ .Site.Params.github_username }}/promptcmd" class="link-btn github" target="_blank" rel="noopener">
              View on GitHub
          </a>
      </div>
  </div>
</div>
<div class="container">
  <div id="install-section" class="install-section">
      <div class="install-header">
          <h2 class="install-title">Get Started in Seconds</h2>
          <p class="install-subtitle">Choose your installation method</p>
      </div>

      <div class="platform-tabs">
          <button class="platform-tab" data-platform="shell" onclick="switchPlatform('shell')">
              Shell Installer
          </button>
          <button class="platform-tab" data-platform="homebrew" onclick="switchPlatform('homebrew')">
              Homebrew
          </button>
          <button class="platform-tab" data-platform="powershell" onclick="switchPlatform('powershell')">
              PowerShell
          </button>
          <button class="platform-tab" data-platform="msi" onclick="switchPlatform('msi')">
              Windows MSI
          </button>
      </div>

      <div class="install-methods">
          <div class="install-method" data-platform="shell">
              <div class="command-box">
                  <code class="command-text">curl -LsSf https://installer.promptcmd.sh | sh</code>
                  <button class="copy-btn" onclick="copyCommand(event)">Copy</button>
              </div>
              <p class="install-note">For Linux and macOS</p>
          </div>

          <div class="install-method" data-platform="homebrew">
              <div class="command-box">
                  <code class="command-text">brew install tgalal/tap/promptcmd</code>
                  <button class="copy-btn" onclick="copyCommand(event)">Copy</button>
              </div>
              <p class="install-note">For macOS via Homebrew</p>
          </div>

          <div class="install-method" data-platform="powershell">
              <div class="command-box">
                  <code class="command-text">powershell -ExecutionPolicy Bypass -c "irm https://installer-ps.promptcmd.sh | iex"</code>
                  <button class="copy-btn" onclick="copyCommand(event)">Copy</button>
              </div>
              <p class="install-note">For Windows via PowerShell</p>
          </div>

          <div class="install-method" data-platform="msi">
              <div class="command-box">
                  <a href="https://installer-msi.promptcmd.sh" class="download-btn" target="_blank" rel="noopener">
                      Download MSI Installer
                  </a>
              </div>
              <p class="install-note">For Windows via MSI package</p>
          </div>
      </div>

  </div>

  <div class="features-section">
      <div class="features-header">
          <h2 class="features-title">See It In Action</h2>
      </div>

      <div class="feature-showcase">

        {{ range $index, $element := .Site.Data.showcase }}
          <div class="feature-item {{ if modBool $index 2 }}reverse{{ end }}">
              <div class="feature-image">
                {{ if $element.cast }}
                <div class="cast-container" data-cast="{{ $element.cast }}"></div>
                {{ else if $element.code }}
                  <div class="code-container">
                  <pre>{{ $element.code | safeHTML }}</pre>
                </div>
                {{ end }}
              </div>
              <div class="feature-content">
              <h3 class="feature-title"> {{ $element.title }} </h3>
                  <p class="feature-description">
                {{ $element.description | safeHTML }}
                  </p>
                  {{ $element.sub | safeHTML }}
              </div>
          </div>
        {{ end }}




          <!--div class="feature-item">
              <div class="feature-image">
  <!--iframe
            src="/cast.html"
            scrolling="no"
            allowfullscreen="true" style="overflow: visible; margin: 0px; border:
            0px; width: 100%; height: 100%; float: none; visibility:
            visible;" title="Terminal session recording"></iframe>
              </div>
              <div class="feature-content">
                  <h3 class="feature-title">Promptception</h3>
                  <p class="feature-description">
                    Chain LLM outputs together to create sophisticated workflows. Use one
                    prompt's insights as input for the next, building complex reasoning
                    pipelines without managing intermediate states yourself.
                </p>
              </div>
          </div-->
      </div>
  </div>
  {{ partial "promptmodal.html" . }}
</div>
<div id="comparison" class="container-fluid comparison-section">
  <div class="comparison-wrapper">
    <h2 class="comparison-title">Related Tools</h2>
    <div class="comparison-table-container">
      <table class="comparison-table">
        <thead>
          <tr>
            <th class="feature-col"></th>
            {{ range .Site.Data.comparison.tools }}
            <th class="tool-col">{{ . | safeHTML }}</th>
            {{ end }}
          </tr>
        </thead>
        <tbody>
          {{ range .Site.Data.comparison.features }}
          <tr>
            <td class="feature-name">{{ .name | safeHTML }}</td>
            <td class="tool-value {{.class}}">{{ .promptcmd | replaceRE "(?i)yes" "<span class=\"check-yes\">✓</span>" | replaceRE "(?i)^no$" "<span class=\"check-no\">✗</span>" | safeHTML }}</td>
            <td class="tool-value {{.class}}">{{ .llm | replaceRE "(?i)^yes$" "<span class=\"check-yes\">✓</span>" | replaceRE "(?i)^no$" "<span class=\"check-no\">✗</span>" | safeHTML }}</td>
            <td class="tool-value {{.class}}">{{ .runprompt | replaceRE "(?i)^yes$" "<span class=\"check-yes\">✓</span>" | replaceRE "(?i)^no$" "<span class=\"check-no\">✗</span>" | safeHTML }}</td>
            <td class="tool-value {{.class}}">{{ .claude_switcher | replaceRE "(?i)^yes$" "<span class=\"check-yes\">✓</span>" | replaceRE "(?i)^no$" "<span class=\"check-no\">✗</span>" | safeHTML }}</td>
          </tr>
          {{ end }}
        </tbody>
      </table>
    </div>
  </div>
</div>

<div class="container cta-section">
  <div class="cta-content">
    <h2 class="cta-title">Ready to Transform Your Workflow?</h2>
    <p class="cta-subtitle">Start building AI-powered commands in minutes</p>

    <div class="platform-tabs cta-tabs">
        <button class="platform-tab" data-platform="shell" onclick="switchPlatform('shell', true)">
            Shell
        </button>
        <button class="platform-tab" data-platform="homebrew" onclick="switchPlatform('homebrew', true)">
            Homebrew
        </button>
        <button class="platform-tab" data-platform="powershell" onclick="switchPlatform('powershell', true)">
            PowerShell
        </button>
        <button class="platform-tab" data-platform="msi" onclick="switchPlatform('msi', true)">
            MSI
        </button>
    </div>

    <div class="install-methods cta-install-methods">
        <div class="install-method" data-platform="shell">
            <div class="command-box cta-command">
                <code class="command-text">curl -LsSf https://installer.promptcmd.sh | sh</code>
                <button class="copy-btn" onclick="copyCommand(event)">Copy</button>
            </div>
        </div>

        <div class="install-method" data-platform="homebrew">
            <div class="command-box cta-command">
                <code class="command-text">brew install tgalal/tap/promptcmd</code>
                <button class="copy-btn" onclick="copyCommand(event)">Copy</button>
            </div>
        </div>

        <div class="install-method" data-platform="powershell">
            <div class="command-box cta-command">
                <code class="command-text">powershell -ExecutionPolicy Bypass -c "irm https://installer-ps.promptcmd.sh | iex"</code>
                <button class="copy-btn" onclick="copyCommand(event)">Copy</button>
            </div>
        </div>

        <div class="install-method" data-platform="msi">
            <div class="command-box cta-command">
                <a href="https://installer-msi.promptcmd.sh" class="download-btn" target="_blank" rel="noopener">
                    Download MSI Installer
                </a>
            </div>
        </div>
    </div>

    <div class="cta-links">
      <a href="https://docs.promptcmd.sh" class="cta-link" target="_blank" rel="noopener">
        <span class="cta-link-icon">→</span> Read the Docs
      </a>
      <a href="{{ "/lib/" | relURL }}" class="cta-link">
        <span class="cta-link-icon">→</span> Browse Examples
      </a>
      <a href="{{ "/creator/" | relURL }}" class="cta-link">
        <span class="cta-link-icon">→</span> Create Your First Prompt
      </a>
    </div>
  </div>
</div>

<script>
window.promptsData = {{ .Site.Data.prompts }};

window.promptContents = {};

{{ range $prompt := .Site.Data.prompts }}
{{ $loadPath := printf "p/%s" $prompt.filename }}
{{ $content := readFile (printf "static/%s" $loadPath) }}
window.promptContents["{{$prompt.filename}}"] = {{ $content }};
{{ end }}

// Auto-scroll showcase carousel on mobile
(function() {
    const container = document.querySelector('.header-showcase-container');
    if (!container) return;

    const items = container.querySelectorAll('.header-showcase-item');
    if (items.length <= 1) return;

    let currentIndex = 0;
    let autoScrollTimer = null;
    let userInteracting = false;

    function scrollToIndex(index) {
        if (index >= items.length) {
            currentIndex = 0;
        } else if (index < 0) {
            currentIndex = items.length - 1;
        } else {
            currentIndex = index;
        }

        const item = items[currentIndex];
        const scrollPosition = item.offsetLeft - container.offsetLeft;
        container.scrollTo({
            left: scrollPosition,
            behavior: 'smooth'
        });
    }

    function startAutoScroll() {
        if (autoScrollTimer) clearInterval(autoScrollTimer);
        autoScrollTimer = setInterval(() => {
            if (!userInteracting) {
                scrollToIndex(currentIndex + 1);
            }
        }, 3000);
    }

    // Detect user interaction
    let scrollTimeout;
    container.addEventListener('scroll', () => {
        userInteracting = true;
        clearTimeout(scrollTimeout);
        scrollTimeout = setTimeout(() => {
            userInteracting = false;
        }, 1000);
    });

    // Start auto-scroll only on mobile/tablet
    if (window.innerWidth < 1025) {
        startAutoScroll();
    }

    // Restart on resize if needed
    window.addEventListener('resize', () => {
        if (window.innerWidth < 1025) {
            if (!autoScrollTimer) startAutoScroll();
        } else {
            if (autoScrollTimer) {
                clearInterval(autoScrollTimer);
                autoScrollTimer = null;
            }
        }
    });
})();

</script>
{{ end }}
